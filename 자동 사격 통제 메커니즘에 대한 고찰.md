# 1. 개요
전차 시뮬레이터의 자동 조준을 구현하려고 한다.
자동 조준에 대해 이야기하기 이전 단어의 정의에 대해서 먼저 정의를 할 것이며, 자동 사격통제에 대한 나의 정의는 다음과 같다

*적을, 또는 적의 이동 방향을 자동으로 조준하여 타격하는 것* 

따라서 적을 향하는 방법과 적의 이동 방향을 예측하는 것이 중간 목표이다

# 2. 적을 향해 조준하는 법
적을 조준하는 법은 세 가지로 사료된다
1. 이미지에서 검출된 적의 위치를 이용하는 것
2. 시뮬레이션 정보에 대한 적의 위치를 참조하여 조준하는 것
3. 위 두 개를 합친 것
`참고로 적을 조준하는 각 방법은 모두 문제가 있다.`
후술에서는 위 세 방법에 대해서 기술할 것이며, 각 요소들에 대한 의사 코드를 작성할 것이다
또한 여기서는 카메라로는 조준 목표에 대한 distance 요소를 검출할 수 없다는 가정 하에 작성한다
## 2.1. 이미지에서 검출된 적의 위치에 대한 것

![[자동 조준 메커니즘에 대한 고찰-20250430-1.png|500]]

우선 완벽한 평면 상에 관찰자와 조준 목표가 있다고 가정한다 
관찰자의 시야에서 적의 위치 움직임은 한 축에서만 동작한다
왜냐하면 평면 상에서의 움직임은 같은 평면의 존재에게는 점이 좌우로 움직이는 것과 마찬가지 이기 때문이다 
- FPS 게임 CS:GO에서의 예시를 들자면 헤드라인을 잡는 것과 똑같다.
- 유효 사거리 내에서 적의 헤드라인은 거의 일정한 높이를 지니고 있다

![[자동 조준 메커니즘에 대한 고찰-20250430.png|500]]
물론 이것은 발사 시 직선 방향으로 즉시 타격하는 히트스캔 방식에서는 통용되는 방식이지만 문제는 우리 시뮬레이터의 화기는 곡사의 형태를 띄는 투사체 방식이기에 거리 값과 탄속에 따른 투발 시간, 피격 시간을 고려해야 한다

따라서 우리는 카메라를 통해 받아온 이미지 데이터만으로 적을 조준한다면, 이는 적에 대한 관찰 이동 축으로 적에 대한 조준하는 용도와 조정에 대한 값을 보정하는 용도로 사용하는 것이 좋은 방법이라고 판단된다.
## 2.2. 시뮬레이션 정보에 대한 적의 위치를 참조하는 것
시뮬레이션의 엔드포인트 `/info`에서 파싱되는 정보는 다음과 같은 형식이다

```json
{
   "time":3.9867117404937744,
   "distance":252.40330505371094,
   "playerPos":{
      "x":60.0,
      "y":8.002116203308105,
      "z":27.229999542236328
   },
   "playerSpeed":0.2987206280231476,
   "playerHealth":100.0,
   "playerTurretX":2.9181717042803257e-09,
   "playerTurretY":0.0,
   "playerBodyX":2.9181717042803257e-09,
   "playerBodyY":-3.256887814995224e-11,
   "playerBodyZ":-9.338149453697042e-08,
   "enemyPos":{
      "x":59.22119903564453,
      "y":8.869277954101562,
      "z":279.630615234375
   },
   "enemySpeed":19.135791778564453,
   "enemyHealth":100.0,
   "enemyTurretX":179.5301055908203,
   "enemyTurretY":-2.180685520172119,
   "enemyBodyX":179.5301055908203,
   "enemyBodyY":2.180685520172119,
   "enemyBodyZ":2.2678720951080322,
   .
   .
   .
   .
   ]
}
```


## 2.3. 이미지 데이터의 검출 값과 시뮬레이션 정보를 퓨전하는 것

